<!DOCTYPE html>
<html>
<head>
    <title>æ”¾ç½®æŒ–çŸ¿æ¸¸æˆ</title>
    <link rel="stylesheet" href="game.css">
</head>
<body>
    <div class="container">
        <h1>çŸ¿æ´æ¢é™©</h1>
        
        <!-- èµ„æºæ˜¾ç¤º -->
        <div id="resources">
            <div>â›ï¸ é“é•: <span id="pickaxe">0</span></div>
            <div>ğŸ’° é‡‘å¸: <span id="gold">0</span></div>
            <div>â› çŸ¿çŸ³: <span id="ore">0</span></div>
        </div>

        <!-- ä¸»è¦æ“ä½œåŒº -->
       <!-- åœ¨åŸæœ‰HTMLçš„action-panelå†…æ›¿æ¢æŒ‰é’® -->
<div class="action-panel">
    <button onclick="startMiningGame()">å¼€å§‹æŒ–çŸ¿</button>
    <div id="minigame-container" style="display: none;">
        <div id="slider-track">
            <div id="target-area"></div>
            <div id="slider"></div>
        </div>
        <p>ç‚¹å‡»åœæ­¢æ»‘å—ï¼</p>
    </div>
    <div id="mining-result"></div>
</div>

<!-- åœ¨game.cssæ·»åŠ æ–°æ ·å¼ -->
<style>
#slider-track {
    width: 300px;
    height: 30px;
    background: #555;
    margin: 20px 0;
    position: relative;
    border-radius: 5px;
}

#slider {
    width: 20px;
    height: 40px;
    background: #e74c3c;
    position: absolute;
    top: -5px;
    left: 0;
    cursor: pointer;
    transition: left 0.1s;
}

#target-area {
    width: 60px;
    height: 100%;
    background: #2ecc71;
    position: absolute;
    left: 120px; /* å±…ä¸­æ˜¾ç¤º */
    opacity: 0.5;
}

#mining-result {
    margin-top: 10px;
    min-height: 20px;
}
</style>

<!-- åœ¨game.jsä¸­æ·»åŠ æ–°é€»è¾‘ -->
<script>
let isMining = false;
let sliderSpeed = 10;
let currentDirection = 1; // 1=å‘å³ï¼Œ-1=å‘å·¦
let sliderPosition = 0;
let animationFrame;

// æ–°çš„æŒ–çŸ¿æ¸¸æˆé€»è¾‘
function startMiningGame() {
    if (isMining) return;
    
    // é‡ç½®çŠ¶æ€
    document.getElementById('minigame-container').style.display = 'block';
    document.getElementById('mining-result').textContent = '';
    isMining = true;
    
    // å¼€å§‹æ»‘å—åŠ¨ç”»
    animateSlider();
}

function stopSlider() {
    if (!isMining) return;
    
    cancelAnimationFrame(animationFrame);
    isMining = false;
    
    // åˆ¤æ–­æ˜¯å¦åœ¨ç›®æ ‡åŒºåŸŸ
    const targetArea = document.getElementById('target-area');
    const targetStart = targetArea.offsetLeft;
    const targetEnd = targetStart + targetArea.offsetWidth;
    
    if (sliderPosition >= targetStart && sliderPosition <= targetEnd) {
        const baseOre = 1 + gameState.pickaxes;
        gameState.ore += baseOre * 2; // æˆåŠŸå¥–åŠ±ç¿»å€
        document.getElementById('mining-result').textContent = `æˆåŠŸæŒ–åˆ° ${baseOre * 2} å—çŸ¿çŸ³ï¼`;
    } else {
        const baseOre = 1 + gameState.pickaxes;
        gameState.ore += Math.floor(baseOre * 0.5); // å¤±è´¥è·å¾—ä¸€åŠ
        document.getElementById('mining-result').textContent = `æŒ–çŸ¿å¤±è´¥ï¼Œåªè·å¾— ${Math.floor(baseOre * 0.5)} å—çŸ¿çŸ³`;
    }
    
    updateDisplay();
    document.getElementById('minigame-container').style.display = 'none';
}

function animateSlider() {
    const trackWidth = document.getElementById('slider-track').offsetWidth - 20;
    
    // æ›´æ–°æ»‘å—ä½ç½®
    sliderPosition += sliderSpeed * currentDirection;
    
    // è¾¹ç•Œæ£€æµ‹
    if (sliderPosition >= trackWidth) {
        currentDirection = -1;
        sliderPosition = trackWidth;
    } else if (sliderPosition <= 0) {
        currentDirection = 1;
        sliderPosition = 0;
    }
    
    // æ›´æ–°æ»‘å—ä½ç½®
    document.getElementById('slider').style.left = sliderPosition + 'px';
    
    // ç»§ç»­åŠ¨ç”»
    animationFrame = requestAnimationFrame(animateSlider);
    
    // éšæœºå˜é€Ÿå¢åŠ éš¾åº¦
    if (Math.random() < 0.02) {
        sliderSpeed = 8 + Math.random() * 8;
    }
}

// æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬
document.getElementById('slider').addEventListener('click', stopSlider);
</script>
        <!-- è‡ªåŠ¨æŒ–çŸ¿çŠ¶æ€ -->
        <div id="auto-status">è‡ªåŠ¨æŒ–çŸ¿: å…³é—­</div>
    </div>
    <script src="game.js"></script>
</body>
</html>
